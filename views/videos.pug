extends layout

block content


  h1= title
  p Welcome to #{title}
  p
    ul
      each video_file in video_files
        li
          a(href="/videos?video_file=" + video_file.name)
            =video_file.name + " " + video_file.time

  video(id="my-video" class="video-js" controls preload="auto" width="640" height="360" data-setup="{}")
    source(id="my-video-src" src="" type="video/mp4")/

    p(class="vjs-no-js").
      To view this video please enable JavaScript, and consider upgrading to a
      web browser that <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>

  p TimeStamp:
    span(id="demo")

  script(src="https://vjs.zencdn.net/7.10.2/video.min.js").
  script(src="//cdn.sc.gl/videojs-hotkeys/0.2/videojs.hotkeys.min.js").

  script.
    function getParameterByName(name, url = window.location.href) {
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }

    let video_src = getParameterByName("video_file");

    document.getElementById("my-video-src").setAttribute("src",`/videos/${video_src}`);

    var aud = videojs('my-video');

    aud.ready(function() {
      this.hotkeys({
        volumeStep: 0.1,
        seekStep: 15,
        enableModifiersForNumbers: false
      });
      this.on('timeupdate', function () {
        console.log(this.currentTime());
        document.getElementById("demo").innerHTML = this.currentTime();
      })
    });